(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7a5dc012"],{"09f4":function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),Math.easeInOutQuad=function(e,t,r,a){return e/=a/2,e<1?r/2*e*e+t:(e--,-r/2*(e*(e-2)-1)+t)};var a=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}();function i(e){document.documentElement.scrollTop=e,document.body.parentNode.scrollTop=e,document.body.scrollTop=e}function n(){return document.documentElement.scrollTop||document.body.parentNode.scrollTop||document.body.scrollTop}function s(e,t,r){var s=n(),o=e-s,l=20,u=0;t="undefined"===typeof t?500:t;var c=function e(){u+=l;var n=Math.easeInOutQuad(u,s,o,t);i(n),u<t?a(e):r&&"function"===typeof r&&r()};c()}},"10ae":function(e,t,r){"use strict";r("5e42")},"127f":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var a=r("40bd"),i=r("7e8c"),n=(r("48d4"),r("8bda"),r("897d")),s=r.n(n),o=r("4109"),l={ossParams:{region:"oss-cn-shenzhen",success_action_status:"200",accessKeyId:"LTAI5tFTcRH7h3RXKoYmnWMk",accessKeySecret:"qdx4B8jIh2VjBgBDG5fNfG0Oj21GSP",bucket:"live-huidapay-net"}};function u(e){var t=e.name.split("."),r=s()(Date.now()+t[0]);return r=r+"."+t[t.length-1],r}function c(e){return new Promise(function(){var t=Object(i["a"])(Object(a["a"])().mark((function t(r,i){var n,s;return Object(a["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=u(e),s=new o({region:l.ossParams.region,accessKeyId:l.ossParams.accessKeyId,accessKeySecret:l.ossParams.accessKeySecret,bucket:l.ossParams.bucket}),t.next=4,s.multipartUpload(n,e);case 4:t.sent,r({url:"https://photo.aiyi.live/"+n});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())}},1517:function(e,t,r){},"1fe8":function(e,t,r){e.exports=r.p+"static/img/error.e53687be.png"},"24c4":function(e,t,r){"use strict";r("1517")},2708:function(e,t,r){"use strict";var a=r("4672"),i=r("52c1"),n={data:function(){return{tabIndex:"0",page:1,size:10,limit:10,searchParams:{},dataParams:{}}},computed:Object(a["a"])({},Object(i["c"])({permissionArr:function(e){return e.permission.permissionArr}})),mounted:function(){console.log(this.permissionArr,"permissionArr")}};t["a"]=n},4414:function(e,t,r){},5091:function(e,t,r){},"5e42":function(e,t,r){},"6edf":function(e,t,r){},"8b77":function(e,t,r){"use strict";r("6edf")},9218:function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return s}));var a=r("829b"),i=r("8daa");function n(e){return Object(a["a"])({url:i["a"].userActivity.dwActivity.configDW,method:"post",data:e})}function s(e){return Object(a["a"])({url:i["a"].platformActivity.addFirstCharge,method:"post",data:e})}},a4c1:function(e,t,r){"use strict";r("4414")},aa8f:function(e,t,r){},bc30:function(e,t,r){"use strict";r("5091")},de48:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"activity-first-charge-box"},[r("menuComp",{ref:"menuComp",attrs:{menuList:e.menuList},model:{value:e.tabIndex,callback:function(t){e.tabIndex=t},expression:"tabIndex"}}),"0"===e.tabIndex&&e.list.length<=0?r("el-button",{staticClass:"btnBox",attrs:{type:"success"},on:{click:e.add}},[e._v("新增")]):e._e(),"0"!==e.tabIndex?r("div",{staticClass:"searchParams"},[r("SearchPanel",{attrs:{forms:e.forms,"show-reset":!0,"show-search-btn":!0},on:{onReset:e.reset,onSearch:e.onSearch},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}})],1):e._e(),r("tableList",{ref:"tableList",attrs:{cfgs:e.cfgs},on:{rowClick:e.rowClick,saleAmunt:e.saleAmunt}}),e.isDestoryComp?r("firstChangeComp",{ref:"firstChangeComp",on:{destoryComp:e.destoryComp,getList:e.getList}}):e._e(),e.isDestoryComp?r("userComp",{ref:"userComp",on:{destoryComp:e.destoryComp,getList:e.getList}}):e._e()],1)},i=[],n=r("40bd"),s=r("7e8c"),o=r("4672"),l=(r("23dc"),r("8bda"),r("48d4"),r("65c4"),r("1a72")),u=r("9218"),c=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"moveDating-cardComp-box"},[r("drawer",{ref:"drawer",attrs:{size:"850px",title:e.title,isShowUpdate:!0,disabled:e.disabled},on:{cancel:e.cancel,submitForm:e.submitForm,closed:e.closed,update:e.update}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{slot:"body",model:e.ruleForm,rules:e.rules,"label-width":"115px","label-suffix":":","hide-required-asterisk":"see"===e.status},slot:"body"},[r("el-form-item",{attrs:{label:"活动名称",prop:"name"}},[r("el-input",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),r("el-form-item",{attrs:{label:"活动图标",prop:"icon"}},[r("uploadImg",{ref:"uploadImg",attrs:{imgUrl:e.ruleForm.icon,name:"icon",accept:".png,.jpg,.jpeg",disabled:e.disabled},on:{validateField:e.validateField},model:{value:e.ruleForm.icon,callback:function(t){e.$set(e.ruleForm,"icon",t)},expression:"ruleForm.icon"}})],1),r("el-form-item",{attrs:{label:"活动类型",prop:"type"}},[r("el-select",{attrs:{placeholder:"请选择",disabled:e.disabled},model:{value:e.ruleForm.type,callback:function(t){e.$set(e.ruleForm,"type",t)},expression:"ruleForm.type"}},e._l(e.typeList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"首充金额",prop:"cost"}},[r("el-input",{attrs:{disabled:!0,onkeydown:"this.value=this.value.replace(/^0+/,'');",oninput:"this.value=this.value.replace(/[^\\d]/g,'');"},model:{value:e.ruleForm.cost,callback:function(t){e.$set(e.ruleForm,"cost",t)},expression:"ruleForm.cost"}})],1),r("el-form-item",{attrs:{label:"赠送单位",prop:"name",rules:e.unitResult}},[r("el-input",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.gain.name,callback:function(t){e.$set(e.ruleForm.gain,"name",t)},expression:"ruleForm.gain.name"}})],1),r("el-form-item",{attrs:{label:"赠送图片",prop:"gain_image",rules:e.ImgResult}},[r("uploadImg",{ref:"uploadImg",attrs:{imgUrl:e.ruleForm.gain.gain_image,name:"gain_image",accept:".png,.jpg,.jpeg",disabled:e.disabled},on:{validateField:e.validateField},model:{value:e.ruleForm.gain.gain_image,callback:function(t){e.$set(e.ruleForm.gain,"gain_image",t)},expression:"ruleForm.gain.gain_image"}})],1),r("el-form-item",{attrs:{label:"赠送价格",prop:"price",rules:e.priceResult}},[r("el-input",{attrs:{disabled:e.disabled,onkeydown:"this.value=this.value.replace(/^0+/,'');",oninput:"this.value=this.value.replace(/[^\\d]/g,'');"},model:{value:e.ruleForm.gain.price,callback:function(t){e.$set(e.ruleForm.gain,"price",t)},expression:"ruleForm.gain.price"}})],1),r("el-form-item",{attrs:{label:"赠送排序",prop:"price",rules:e.sortResult}},[r("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:e.disabled},model:{value:e.ruleForm.gain.sort,callback:function(t){e.$set(e.ruleForm.gain,"sort",t)},expression:"ruleForm.gain.sort"}},e._l(e.locationList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.value,disabled:e.disabled}})})),1)],1),r("el-form-item",{attrs:{label:"开始时间",prop:"start_time",rules:e.StartRules}},[r("el-date-picker",{attrs:{disabled:e.disabled,"value-format":"timestamp",type:"datetime","picker-options":e.StartPicker,placeholder:"请选择开始时间"},model:{value:e.ruleForm.start_time,callback:function(t){e.$set(e.ruleForm,"start_time",t)},expression:"ruleForm.start_time"}})],1),r("el-form-item",{attrs:{label:"结束时间",prop:"end_time",rules:e.EndRules}},[r("el-date-picker",{attrs:{disabled:e.disabled,"picker-options":e.EndPicker,"value-format":"timestamp",type:"datetime",placeholder:"请选择结束时间"},model:{value:e.ruleForm.end_time,callback:function(t){e.$set(e.ruleForm,"end_time",t)},expression:"ruleForm.end_time"}})],1),r("el-form-item",{attrs:{label:"添加礼物"}},[r("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){return e.$refs.gift.handleAddGiftShow()}}},[e._v("添 加")])],1),r("gift",{ref:"gift",attrs:{isShowProperty:!0,status:e.status,isShowLocation:!0,activityType:e.ruleForm.code,list:e.ruleForm.gifts,disabled:e.disabled,max:100,locationList:e.locationList}}),r("el-form-item",{attrs:{label:"添加商品"}},[r("el-button",{attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){return e.$refs.goodsComp.loadParams()}}},[e._v("添 加")])],1),r("goodsComp",{ref:"goodsComp",attrs:{list:e.ruleForm.goods,disabled:e.disabled,max:7,locationList:e.locationList,isShowLocation:!0}})],1)],1)],1)},d=[],m=(r("00e5"),r("96c5"),r("ee6e"),r("1af9"),r("9dcb"),r("0472")),f=r("40cb"),p=r("899e"),g=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shoppingComp-box"},[r("tableComp",{ref:"tableComp",attrs:{list:e.goods,disabled:e.disabled,max:e.max,locationList:e.locationList,isShowLocation:e.isShowLocation}}),r("goodsBank",{ref:"goodsBank",attrs:{isLimit:99999999,list:e.goods},on:{validateField:e.validateField}})],1)},b=[],h=(r("6166"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"shoppingComp-table-box"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.list}},[r("el-table-column",{attrs:{prop:"date",align:"center",label:"商品图标"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("imgComp",{ref:"imgComp",attrs:{height:"50px",src:e.returnImg(t.row),"preview-src-list":e.returnImg(t.row)}})]}}])}),r("el-table-column",{attrs:{prop:"goods_name",align:"center",label:"商品名称"}}),r("el-table-column",{attrs:{prop:"address",align:"center",label:"商品天数"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{attrs:{onkeydown:"this.value=this.value.replace(/^0+/,'');",oninput:"this.value=this.value.replace(/[^\\d]/g,'');",disabled:e.disabled},on:{input:function(r){return e.numberInput(t.row)}},model:{value:t.row.use_date,callback:function(r){e.$set(t.row,"use_date",r)},expression:"scope.row.use_date"}}),e._v("天 "),t.row.use_date?e._e():r("div",{staticClass:"errorMsg"},[e._v("请选择")])]}}])}),e.isShowLocation?r("el-table-column",{attrs:{label:"商品位置",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-select",{attrs:{clearable:"",placeholder:"请选择",disabled:e.disabled},model:{value:t.row.sort,callback:function(r){e.$set(t.row,"sort",r)},expression:"scope.row.sort"}},e._l(e.locationFunc,(function(e){return r("el-option",{key:e.value,attrs:{label:e.value,value:e.value,disabled:e.disabled}})})),1),t.row.sort?e._e():r("div",{staticClass:"errorMsgCopy"},[e._v("请选择")])]}}],null,!1,231285759)}):e._e(),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"danger",disabled:e.disabled},on:{click:function(r){return e.deleteParams(t.$index)}}},[e._v("删除")])]}}])})],1)],1)}),v=[],_=(r("2910"),r("5a1e")),y=r("279a"),w={components:{imgComp:_["a"]},props:{list:{type:Array,default:[]},disabled:{type:Boolean,default:!1},isShowLocation:{type:Boolean,default:!1},max:{type:Number,default:null},locationList:{type:Array,default:function(){return[]}}},data:function(){return{locationListCopy:y["a"].LOCATIONLIST}},computed:{locationFunc:function(){if(this.locationList&&this.locationList.length>0)return this.locationList;var e=JSON.parse(JSON.stringify(this.locationListCopy));return this.list.forEach((function(t){e.forEach((function(e){t.sort===e.value&&(e.disabled=!0)}))})),e}},methods:{returnImg:function(e){return e.goods_animation_path?e.goods_animation_path:e.goods_image},deleteParams:function(e){this.list.splice(e,1)},numberInput:function(e){this.max&&Number(e.use_date)>this.max&&(e.use_date=this.max)}}},x=w,F=(r("10ae"),r("e607")),k=Object(F["a"])(x,h,v,!1,null,null,null),C=k.exports,L=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"share-goodsBank-box"},[r("el-drawer",{attrs:{"append-to-body":!0,title:"商品库",visible:e.drawer,direction:e.direction,"before-close":e.handleClose},on:{"update:visible":function(t){e.drawer=t},closed:e.closed}},[r("div",{staticClass:"giftListBox"},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.giftLoading,expression:"giftLoading"}],ref:"giftTable",attrs:{data:e.giftListArr,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{label:"商品名称",prop:"goods_name",align:"center","show-overflow-tooltip":""}}),r("el-table-column",{staticStyle:{display:"flex","justify-content":"center"},attrs:{label:"商品图片",prop:"gift_genre",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",{staticClass:"imgStyle",staticStyle:{display:"flex","justify-content":"center"}},[t.row.goods_image?r("el-image",{staticStyle:{height:"50px"},attrs:{src:t.row.goods_image}}):e._e(),t.row.goods_animation_path?r("svgComp",{ref:"svgComp",attrs:{src:t.row.goods_animation_path,styleObj:{height:"50px"}}}):e._e()],1)]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.isSelect?r("el-button",{attrs:{type:"primary"},on:{"~click":function(r){return e.handleSelect(t.row)}}},[e._v("使用")]):e._e()]}}])})],1),r("pagination",{directives:[{name:"show",rawName:"v-show",value:e.giftTotal>0,expression:"giftTotal>0"}],attrs:{total:e.giftTotal,page:e.giftPage.page,limit:e.giftPage.limit},on:{"update:page":function(t){return e.$set(e.giftPage,"page",t)},"update:limit":function(t){return e.$set(e.giftPage,"limit",t)},pagination:e.giftList}})],1)])],1)},S=[],O=(r("ed70"),r("333d")),$=r("e5de"),T=r("1990"),P={components:{Pagination:O["a"],svgComp:T["a"]},props:{list:{type:Array,default:[]},activityType:{type:String,default:""},status:{type:String,default:""},isLimit:{type:Number,default:1}},data:function(){return{drawer:!1,direction:"rtl",giftLoading:!1,giftListArr:[],giftPage:{page:1,limit:10,goods_type:null},giftTotal:0,giftTypeList:y["a"].GIFTTYPE,isDestroyComp:!1,activityList:y["a"].ACTIVITYLIST}},computed:{gifts:{get:function(){return this.list},set:function(e){return this.$emit("update: list",e)}}},watch:{status:{handler:function(e,t){this.giftPage.page=1,this.giftList()},deep:!0}},methods:{giftList:function(){var e=this,t={page:this.giftPage.page,goods_type:this.giftPage.goods_type};this.giftListArr=[],Object($["c"])(t).then((function(t){e.giftTotal=t.data.count,e.giftListArr=t.data.list,e.giftSelectSource()})).catch((function(e){}))},deleteData:function(e){var t=e.row;e.index;this.giftListArr.forEach((function(e){e.id===t.id&&(e.isSelect=!1)}))},handleClose:function(e){this.drawer=!1},handleSelect:function(e){var t=this;this.gifts.length<this.isLimit?this.giftListArr.map((function(r){r.id==e.id&&(r.isSelect=!0,t.gifts.push(e))})):(this.$message.error("最多只能赠送一个商品"),this.drawer=!1,this.$emit("validateField"))},giftSelectSource:function(){var e=this;this.giftListArr.map((function(t){t.isSelect=!1,e.gifts.length>0&&e.gifts.map((function(e){e.id!=t.id&&e.id!=t.id||(t.isSelect=!0)}))})),this.$forceUpdate()},closed:function(){this.$emit("distoryComp")}}},j=P,I=(r("24c4"),Object(F["a"])(j,L,S,!1,null,null,null)),D=I.exports,A={components:{tableComp:C,goodsBank:D},props:{list:{type:Array,default:[]},disabled:{type:Boolean,default:!1},max:{type:Number,default:null},locationList:{type:Array,default:function(){return[]}},isShowLocation:{type:Boolean,default:!1}},computed:{goods:{get:function(){return this.list},set:function(e){this.$emit("update:list",e)}}},data:function(){return{}},methods:{validateField:function(){},loadParams:function(){this.$refs.goodsBank.drawer=!0,this.$refs.goodsBank.giftList()}}},E=A,N=(r("a4c1"),Object(F["a"])(E,g,b,!1,null,null,null)),Y=N.exports,M={components:{uploadImg:f["a"],drawer:m["a"],gift:p["a"],goodsComp:Y},data:function(){return{status:"add",oldParams:{},typeList:y["a"].DWACTIVITYTYPE,positionList:y["a"].LOCATIONLIST,ruleForm:{id:null,name:"",code:"scpz",type:null,icon:"",cost:6,start_time:"",end_time:"",gifts:[],goods:[],gain:{name:"喵粮",gain_image:"",price:"",sort:4}},rules:{name:[{required:!0,message:"请输入活动名称",trigger:"blur"}],cost:[{required:!0,message:"请输入首充金额",trigger:"blur"}],icon:[{required:!0,message:"请上传活动图标",trigger:"change"}],type:[{required:!0,message:"请选择活动类型",trigger:"change"}]}}},computed:{title:function(){return"add"===this.status?"新增首充活动":"update"===this.status?"修改首充活动":"查看首充活动"},disabled:function(){return"see"===this.status},StartRules:function(){var e={},t=this.ruleForm.start_time;return e={required:!0,validator:function(e,r,a){t?a():a(new Error("请选择开始时间"))}},e},EndRules:function(){var e={},t=this.ruleForm.start_time,r=this.ruleForm.end_time;return e={required:!0,validator:function(e,a,i){r<(new Date).getTime()&&i(new Error("结束时间不能小于当前时间!")),t&&r<=t?i(new Error("结束时间不能小于开始时间!")):i()}},e},StartPicker:function(){return{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}}},EndPicker:function(){var e=this;return{disabledDate:function(t){return e.ruleForm.start_time?t.getTime()<e.ruleForm.start_time-864e5:t.getTime()<(new Date).getTime()-864e5}}},unitResult:function(){var e=this,t={};return t={required:!0,validator:function(t,r,a){var i=e.ruleForm.gain;i.name?a():a(new Error("请输入赠送单位"))}},t},ImgResult:function(){var e=this,t={};return t={required:!0,validator:function(t,r,a){var i=e.ruleForm.gain;i.gain_image?a():a(new Error("请上传赠送图片"))}},t},priceResult:function(){var e=this,t={};return t={required:!0,validator:function(t,r,a){var i=e.ruleForm.gain;i.price?a():a(new Error("请填写赠送价格"))}},t},locationList:function(){var e=this,t=this.positionList.filter((function(e){return e.value<5})),r=JSON.parse(JSON.stringify(t)),a=this.ruleForm;return r.forEach((function(t){a.goods&&a.goods.length>0&&a.goods.forEach((function(e){e.sort===t.value&&(t.disabled=!0)})),a.gifts&&a.gifts.length>0&&a.gifts.forEach((function(e){e.sort===t.value&&(t.disabled=!0)})),t.value===e.ruleForm.gain.sort&&(t.disabled=!0)})),r},sortResult:function(){var e=this,t={};return t={required:!0,validator:function(t,r,a){var i=e.ruleForm.gain;i.sort?a():a(new Error("请选择赠送排序"))}},t}},methods:{handleClose:function(){this.dialogVisible=!1},loadParams:function(e,t){var r=this;return Object(s["a"])(Object(n["a"])().mark((function a(){var i,s;return Object(n["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r.openComp(),r.status=e,"add"===e){a.next=12;break}return i=JSON.parse(JSON.stringify(t)),i.start_time=1e3*i.start_time,i.end_time=1e3*i.end_time,i.cost=6,i.gain.sort=4,a.next=10,Object(l["E"])({activity_id:t.id});case 10:s=a.sent,2e3===s.code&&(s.data.goods&&s.data.goods.length>0&&s.data.goods.forEach((function(e){e.goods_name=e.gift_name,-1!==e.gift_photo.indexOf(".svga")?e.goods_animation_path=e.gift_photo:e.goods_image=e.gift_photo})),i.goods=s.data.goods||[],i.gifts=s.data.gifts||[],r.$set(r.$data,"ruleForm",i));case 12:r.oldParams=JSON.parse(JSON.stringify(r.ruleForm));case 13:case"end":return a.stop()}}),a)})))()},openComp:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$refs.drawer.loadParams(e)},cancel:function(){var e=this;JSON.stringify(this.oldParams)!==JSON.stringify(this.ruleForm)?this.$confirm("关闭弹窗将不会保留您的更改, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.openComp(!1)})).catch((function(){})):this.openComp(!1)},update:function(){this.status="update"},submitForm:function(e){var t=this;return Object(s["a"])(Object(n["a"])().mark((function r(){return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs[e].validate(function(){var e=Object(s["a"])(Object(n["a"])().mark((function e(r){var a,i,s,l,c,d;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=33;break}if(a=Object(o["a"])({},t.ruleForm),a.start_time=Math.floor(a.start_time/1e3),a.end_time=Math.floor(a.end_time/1e3),!(a.goods.length<=0&&a.goods.length<=0)){e.next=7;break}return t.$error("请至少添加一个商品或礼物"),e.abrupt("return",!1);case 7:if(!(a.gifts&&a.gifts.length>0)){e.next=17;break}if(i=a.gifts.find((function(e){return!e.gift_number})),s=a.gifts.find((function(e){return!e.sort})),!i){e.next=13;break}return t.$warning("请先输入礼物".concat(i.gift_name,"的礼物数量")),e.abrupt("return",!1);case 13:if(!s){e.next=16;break}return t.$warning("请先选择礼物".concat(s.gift_name,"的礼物位置")),e.abrupt("return",!1);case 16:a.gifts=a.gifts.map((function(e){return{id:e.id,gift_number:e.gift_number,sort:e.sort}}));case 17:if(!(a.goods&&a.goods.length>0)){e.next=27;break}if(l=a.goods.find((function(e){return!e.use_date})),c=a.goods.find((function(e){return!e.sort})),!l){e.next=23;break}return t.$warning("请先输入商品".concat(l.goods_name,"的商品数量")),e.abrupt("return",!1);case 23:if(!c){e.next=26;break}return t.$warning("请先选择商品".concat(c.goods_name,"的商品位置")),e.abrupt("return",!1);case 26:a.goods=a.goods.map((function(e){return{id:e.id,use_date:e.use_date,sort:e.sort}}));case 27:return e.next=29,Object(u["a"])(a);case 29:d=e.sent,2e3===d.code&&("add"===t.status?t.$success("新增成功"):t.$success("修改成功"),t.openComp(!1),t.$emit("getList")),e.next=35;break;case 33:return console.log("error submit!!"),e.abrupt("return",!1);case 35:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},resetForm:function(e){this.$refs[e].resetFields()},validateField:function(e){this.$refs.ruleForm.validateField([e])},closed:function(){this.$emit("destoryComp")}}},B=M,R=(r("bc30"),Object(F["a"])(B,c,d,!1,null,null,null)),q=R.exports,J=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"activity-userComp-box"},[r("drawer",{ref:"drawer",attrs:{size:"470px",title:"查看首充用户详情",disabled:e.disabled},on:{cancel:e.cancel}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{slot:"body",model:e.ruleForm,rules:e.rules,"label-width":"115px","label-suffix":":","hide-required-asterisk":"see"===e.status},slot:"body"},[r("el-form-item",{attrs:{label:"用户昵称",prop:"nickname"}},[r("el-input",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.nickname,callback:function(t){e.$set(e.ruleForm,"nickname",t)},expression:"ruleForm.nickname"}})],1),r("el-form-item",{attrs:{label:"用户ID",prop:"user_number"}},[r("el-input",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.user_number,callback:function(t){e.$set(e.ruleForm,"user_number",t)},expression:"ruleForm.user_number"}})],1),r("el-form-item",{attrs:{label:"首充时间",prop:"first_charge_time"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择首充时间",disabled:e.disabled},model:{value:e.ruleForm.first_charge_time,callback:function(t){e.$set(e.ruleForm,"first_charge_time",t)},expression:"ruleForm.first_charge_time"}})],1),r("el-form-item",{attrs:{label:"性别",prop:"sex"}},[r("el-select",{attrs:{placeholder:"请选择性别",disabled:e.disabled},model:{value:e.ruleForm.sex,callback:function(t){e.$set(e.ruleForm,"sex",t)},expression:"ruleForm.sex"}},e._l(e.sexList,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1),r("el-form-item",{attrs:{label:"注册时间",prop:"register_time"}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择注册时间",disabled:e.disabled},model:{value:e.ruleForm.register_time,callback:function(t){e.$set(e.ruleForm,"register_time",t)},expression:"ruleForm.register_time"}})],1),r("el-form-item",{attrs:{label:"间隔时间",prop:"interval_time"}},[r("el-input",{attrs:{disabled:e.disabled},model:{value:e.ruleForm.interval_time,callback:function(t){e.$set(e.ruleForm,"interval_time",t)},expression:"ruleForm.interval_time"}})],1)],1)],1)],1)},z=[],H={components:{drawer:m["a"]},data:function(){return{status:"see",sexList:y["a"].SEXLIST,ruleForm:{},rules:{}}},computed:{disabled:function(){return!0}},methods:{handleClose:function(){this.openComp(!1)},loadParams:function(e){this.openComp();var t=JSON.parse(JSON.stringify(e));t.first_charge_time=1e3*t.first_charge_time,t.register_time=1e3*t.register_time,this.$set(this.$data,"ruleForm",t)},openComp:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.$refs.drawer.loadParams(e)},cancel:function(){this.openComp(!1)}}},K=H,W=(r("e07e"),Object(F["a"])(K,J,z,!1,null,null,null)),G=W.exports,U=r("3923"),V=r("04a2"),X=r("4053"),Q=r("8daa"),Z=r("cf45"),ee=r("2708"),te={mixins:[ee["a"]],components:{SearchPanel:V["a"],tableList:X["a"],menuComp:U["a"],firstChangeComp:q,userComp:G},data:function(){return{isDestoryComp:!1,tabIndex:"0",menuList:[{name:"首充配置"},{name:"首充用户"}],list:[]}},computed:{forms:function(){var e=this,t=[{name:"user_number",type:"input",value:"",label:"用户ID",isNum:!0,placeholder:"请输入用户ID"},{name:"dateTimeParams",type:"datePicker",dateType:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",label:"时间选择",value:"",handler:{change:function(t){e.emptyDateTime(),e.setDateTime(t)},selectChange:function(t,r){e.emptyDateTime()}}}];return"0"===this.tabIndex?[]:t},cfgs:function(){var e,t,r=this,a=[{label:"活动名称",prop:"name"},{label:"礼物种类数量",prop:"gift_count"},{label:"首充设置金额",prop:"cost"},{label:"活动状态",render:function(e,t){var r=1e3*t.row.start_time,a=1e3*t.row.end_time,i=(new Date).getTime();return r>i&&a>i?e("span",{style:{color:"green"}},"未开始"):r<i&&a>i?e("span",{style:{color:"green"}},"开始中"):a<i?e("span",{style:{color:"red"}},"结束"):void 0}},{label:"开始时间",minWidth:"100px",render:function(e,t){return e("span",t.row.start_time?Object(Z["h"])(t.row.start_time,"YYYY-MM-DD HH:mm:ss",!0):"无")}},{label:"结束时间",minWidth:"100px",render:function(e,t){return e("span",t.row.end_time?Object(Z["h"])(t.row.end_time,"YYYY-MM-DD HH:mm:ss",!0):"无")}},{label:"操作",minWidth:"120px",render:function(e,t){return e("div",[e("el-button",{props:{type:"primary"},on:{click:function(){r.update(t.row)}}},"修改"),e("el-button",{props:{type:"danger"},on:{click:function(){r.freeze(t.row)}}},"冻结")])}}],i=[{label:"首充时间",render:function(e,t){return e("span",t.row.first_charge_time?Object(Z["h"])(t.row.first_charge_time,"YYYY-MM-DD HH:mm:ss",!0):"无")}},{label:"用户",render:function(e,t){return e("div",[e("div",t.row.nickname),e("div",t.row.user_number)])}},{label:"性别",render:function(e,t){var r=y["a"].SEXLIST.find((function(e){return e.value===t.row.sex}));return e("span",r?r.name:"无")}},{label:"注册时间",render:function(e,t){return e("span",t.row.register_time?Object(Z["h"])(t.row.register_time,"YYYY-MM-DD HH:mm:ss",!0):"无")}},{label:"间隔时间",prop:"interval_time"}];return"0"===this.tabIndex?(e=a,t="Activityins"):(e=i,t="chargeLog"),{vm:this,url:Q["a"].platformActivity[t],columns:e}}},methods:{beforeSearch:function(e){var t=Object(o["a"])(Object(o["a"])({},this.searchParams),this.dateTimeParams),r={page:e.page,page_size:e.size,start_time:t.start_time?Math.floor(t.start_time/1e3):"",end_time:t.end_time?Math.floor(t.end_time/1e3):"",user_number:t.user_number,code:"scpz"};return"0"===this.tabIndex?(delete r.start_time,delete r.end_time,delete r.user_number):delete r.code,r},getList:function(){this.$refs.tableList.getData()},setDateTime:function(e){var t=e?{start_time:e[0],end_time:e[1]}:{};this.$set(this,"dateTimeParams",t)},emptyDateTime:function(){this.dateTimeParams={}},reset:function(){this.searchParams={},this.dateTimeParams={},this.getList()},add:function(){this.load("add")},update:function(e){this.load("update",e)},rowClick:function(e){this.load("see",e)},load:function(e,t){var r=this;this.isDestoryComp=!0,setTimeout((function(){"0"===r.tabIndex?r.$refs.firstChangeComp.loadParams(e,t):r.$refs.userComp.loadParams(t)}),50)},freeze:function(e){var t=this;return Object(s["a"])(Object(n["a"])().mark((function r(){var a,i,s;return Object(n["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=JSON.parse(JSON.stringify(e)),r.next=3,Object(l["E"])({activity_id:a.id});case 3:return i=r.sent,a.end_time=Math.floor(((new Date).getTime()-1)/1e3),a.goods=i.data.goods||[],a.gifts=i.data.gifts||[],r.next=9,Object(u["a"])(a);case 9:s=r.sent,2e3===s.code&&(t.$success("冻结成功"),t.getList());case 11:case"end":return r.stop()}}),r)})))()},onSearch:function(){this.getList()},destoryComp:function(){this.isDestoryComp=!1},saleAmunt:function(e){this.list=e.list||[]}}},re=te,ae=(r("8b77"),Object(F["a"])(re,a,i,!1,null,null,null));t["default"]=ae.exports},e07e:function(e,t,r){"use strict";r("aa8f")},e5de:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return l}));var a=r("829b"),i=r("8daa");function n(e){return Object(a["a"])({url:i["a"].shopping.add,method:"post",data:e})}function s(e){return Object(a["a"])({url:i["a"].shopping.down,method:"post",data:e})}function o(e){return Object(a["a"])({url:i["a"].shopping.list,method:"post",data:e})}function l(e){return Object(a["a"])({url:i["a"].shopping.send,method:"post",data:e})}}}]);