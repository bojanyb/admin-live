(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fa5fda7"],{"1fe8":function(e,t,r){e.exports=r.p+"static/img/error.e53687be.png"},2708:function(e,t,r){"use strict";var a=r("4672"),s=r("52c1"),o={data:function(){return{tabIndex:"0",page:1,size:10,limit:10,searchParams:{},dataParams:{}}},computed:Object(a["a"])({},Object(s["c"])({permissionArr:function(e){return e.permission.permissionArr}})),mounted:function(){console.log(this.permissionArr,"permissionArr")}};t["a"]=o},"9f7a":function(e,t,r){"use strict";r("c769")},a868:function(e,t,r){"use strict";r("f57b")},c769:function(e,t,r){},f0e2:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"push-notice"},[r("div",{staticClass:"searchParams"},[r("SearchPanel",{attrs:{forms:e.forms,"show-add":!0,"show-search-btn":!0},on:{add:e.add,onSearch:e.onSearch},model:{value:e.searchParams,callback:function(t){e.searchParams=t},expression:"searchParams"}})],1),r("tableList",{ref:"tableList",attrs:{cfgs:e.cfgs}}),e.isDestoryComp?r("editComp",{ref:"editComp",on:{destoryComp:e.destoryComp,getList:e.getList}}):e._e()],1)},s=[],o=r("4672"),l=(r("23dc"),r("8bda"),r("5250"),r("48d4"),r("3923")),i=r("04a2"),n=r("4053"),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dialog_body_box"},[r("el-dialog",{attrs:{title:e.title,width:"600px",visible:e.isEditComp},on:{closed:e.closed,"update:visible":function(t){e.isEditComp=t}}},[r("el-form",{ref:"ruleForm",staticClass:"body_box-line",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"90px","label-suffix":":"}},[r("el-form-item",{staticClass:"body_box-line",attrs:{label:"推送标题",prop:"title"}},[r("el-input",{attrs:{placeholder:"请输入push推送标题"},model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{staticClass:"body_box-line",attrs:{label:"推送内容",prop:"content"}},[r("el-input",{attrs:{type:"textarea",rows:"3",resize:"none",placeholder:"请输入推送内容"},model:{value:e.ruleForm.content,callback:function(t){e.$set(e.ruleForm,"content",t)},expression:"ruleForm.content"}})],1),0===e.ruleForm.push_type||2===e.ruleForm.push_type?r("el-form-item",{staticClass:"body_box-line",attrs:{label:"落地类型",prop:"push_val",rules:[{required:0!==e.ruleForm.push_type,message:"请输入落地类型值",trigger:"blur"}]}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入落地类型值",disabled:0===e.ruleForm.push_type},model:{value:e.ruleForm.push_val,callback:function(t){e.$set(e.ruleForm,"push_val",t)},expression:"ruleForm.push_val"}},[r("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},on:{change:e.typeChange},slot:"prepend",model:{value:e.ruleForm.push_type,callback:function(t){e.$set(e.ruleForm,"push_type",t)},expression:"ruleForm.push_type"}},e._l(e.pushTypeOptinos,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1):3===e.ruleForm.push_type?r("el-form-item",{staticClass:"body_box-line",attrs:{label:"落地类型",prop:"push_val",rules:[{required:!0,message:"请输入落地类型值",trigger:"blur"},{required:!0,pattern:/(http|https):\/\/([\w.]+\/?)\S*/gi,message:"请输入http或者https开头的网络地址",trigger:"blur"}]}},[r("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入http或者https开头的网络地址",disabled:0===e.ruleForm.push_type},model:{value:e.ruleForm.push_val,callback:function(t){e.$set(e.ruleForm,"push_val",t)},expression:"ruleForm.push_val"}},[r("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},on:{change:e.typeChange},slot:"prepend",model:{value:e.ruleForm.push_type,callback:function(t){e.$set(e.ruleForm,"push_type",t)},expression:"ruleForm.push_type"}},e._l(e.pushTypeOptinos,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1):e._e(),r("el-row",{staticClass:"body_box-col"},[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"目标用户",prop:"target_type"}},[r("el-select",{attrs:{placeholder:"请选择目标用户"},model:{value:e.ruleForm.target_type,callback:function(t){e.$set(e.ruleForm,"target_type",t)},expression:"ruleForm.target_type"}},e._l(e.targetTypeOptinos,(function(e){return r("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})})),1)],1)],1),r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"时间范围",prop:"days"}},[r("el-row",[r("el-col",{attrs:{span:22}},[r("el-input",{directives:[{name:"input-num",rawName:"v-input-num",value:!0,expression:"true"}],attrs:{placeholder:"天"},model:{value:e.ruleForm.days,callback:function(t){e.$set(e.ruleForm,"days",e._n(t))},expression:"ruleForm.days"}})],1),r("el-col",{attrs:{span:2}},[e._v(" 内 ")])],1)],1)],1)],1),e.isUserId?r("el-form-item",{staticClass:"body_box-line",attrs:{label:"用户ID",prop:"target_val"}},[r("el-input",{attrs:{type:"textarea",rows:"3",resize:"none",placeholder:"请输入自定义推送用户ID"},model:{value:e.ruleForm.target_val,callback:function(t){e.$set(e.ruleForm,"target_val",t)},expression:"ruleForm.target_val"}})],1):e._e()],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")])],1)],1)],1)},p=[],c=r("40bd"),m=r("7e8c"),d=(r("65c4"),r("1a72")),h=r("279a"),f={components:{},data:function(){return{status:"add",isEditComp:!1,ruleForm:{push_type:0,push_val:"",target_val:""},oldParams:{},rules:{title:[{required:!0,message:"请输入推送标题",trigger:"blur"}],content:[{required:!0,message:"请输入推送内容",trigger:"blur"}],target_type:[{required:!0,message:"请选择目标用户",trigger:"change"}],days:[{required:!0,message:"请输入时间范围",trigger:"blur"}]},pushTypeOptinos:h["a"].PUSHTYPESTATUS,targetTypeOptinos:h["a"].TARGETTYPESTATUS,isUserId:!1}},computed:{title:function(){return"push推送"}},watch:{"ruleForm.target_type":{handler:function(e){7==e?(this.isUserId=!0,this.rules.target_val=[{required:this.rules,message:"请输入自定义公户ID",trigger:"blur"}]):this.rules.target_val=[{}]}}},methods:{loadParams:function(e,t){if(this.openComp(),this.status=e,"add"!==e){var r=JSON.parse(JSON.stringify(t)),a={};a.title=r.title?r.title:"",a.content=r.content?r.content:"",a.push_val=r.push_val?r.push_val:"",a.push_type=r.push_type?r.push_type:"",a.target_type=r.target_type,a.days=r.days,this.$set(this.$data,"ruleForm",a)}this.oldParams=JSON.parse(JSON.stringify(this.ruleForm))},openComp:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isEditComp=e},cancel:function(){var e=this;JSON.stringify(this.oldParams)!==JSON.stringify(this.ruleForm)?this.$confirm("关闭弹窗将不会保留您的更改, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.openComp(!1)})).catch((function(){})):this.openComp(!1)},submitForm:function(){var e=this;return Object(m["a"])(Object(c["a"])().mark((function t(){return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.ruleForm.validate(function(){var t=Object(m["a"])(Object(c["a"])().mark((function t(r){var a,s;return Object(c["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!r){t.next=10;break}return a=Object(o["a"])({},e.ruleForm),t.next=4,Object(d["e"])(a);case 4:s=t.sent,2e3===s.code&&e.$success("新增成功"),e.openComp(!1),e.$emit("getList"),t.next=12;break;case 10:return console.log("error submit!!"),t.abrupt("return",!1);case 12:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)})))()},resetForm:function(){this.openComp(!1)},validateField:function(e){this.$refs.ruleForm.validateField([e])},closed:function(){this.$emit("destoryComp")},typeChange:function(e){e||(this.ruleForm.push_val="")}}},b=f,g=(r("9f7a"),r("e607")),_=Object(g["a"])(b,u,p,!1,null,"03f47011",null),y=_.exports,v=r("8daa"),F=r("2708"),C={name:"BroadcastList",mixins:[F["a"]],components:{SearchPanel:i["a"],tableList:n["a"],editComp:y,menuComp:l["a"]},data:function(){return{isDestoryComp:!1}},computed:{forms:function(){var e=this,t=[{name:"title",type:"input",value:"",label:"消息标题",placeholder:"请输入消息标题"},{name:"dateTimeParams",type:"datePicker",dateType:"datetimerange",format:"yyyy-MM-dd HH:mm:ss",label:"创建时间",value:"",handler:{change:function(t){e.emptyDateTime(),e.setDateTime(t),e.getList()},selectChange:function(t,r){e.emptyDateTime(),e.getList()}}}];return t},cfgs:function(){return{vm:this,url:v["a"].message.pushLogList,columns:[{label:"创建时间",prop:"create_time",minWidth:"180px"},{label:"推送标题",prop:"title"},{label:"推送内容",prop:"content"},{label:"落地类型",prop:"push_type",render:function(e,t){var r=h["a"].PUSHTYPESTATUS.find((function(e){return e.value===t.row.push_type}));return e("span",r?"".concat(r.name,"：").concat(t.row.push_val):"无")}},{label:"操作人",prop:"admin_user_nickname"}]}}},methods:{beforeSearch:function(e){var t=Object(o["a"])(Object(o["a"])({},this.searchParams),this.dateTimeParams);return{page:e.page,pagesize:e.size,title:t.title,start_time:t.start_time?Math.floor(t.start_time/1e3):0,end_time:t.end_time?Math.floor(t.end_time/1e3):0}},getList:function(){this.$refs.tableList.getData()},setDateTime:function(e){var t=e?{start_time:e[0],end_time:e[1]}:{};this.$set(this,"dateTimeParams",t)},emptyDateTime:function(){this.dateTimeParams={}},add:function(){this.load("add")},load:function(e,t){var r=this;this.isDestoryComp=!0,setTimeout((function(){r.$refs.editComp.loadParams(e,t)}),50)},onSearch:function(){this.getList()},destoryComp:function(){this.isDestoryComp=!1}}},x=C,T=(r("a868"),Object(g["a"])(x,a,s,!1,null,null,null));t["default"]=T.exports},f57b:function(e,t,r){}}]);