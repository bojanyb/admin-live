(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6cbd1b19"],{"127f":function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var i=r("c7eb"),n=r("1da1"),a=(r("b0c0"),r("d3b7"),r("8237")),s=r.n(a),o=r("9b15"),u={ossParams:{region:"oss-cn-shenzhen",success_action_status:"200",accessKeyId:"LTAI5tFTcRH7h3RXKoYmnWMk",accessKeySecret:"qdx4B8jIh2VjBgBDG5fNfG0Oj21GSP",bucket:"live-huidapay-net"}};function c(e){var t=e.name.split("."),r=s()(Date.now()+t[0]);return r=r+"."+t[t.length-1],r}function l(e){return new Promise(function(){var t=Object(n["a"])(Object(i["a"])().mark((function t(r,n){var a,s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=c(e),s=new o({region:u.ossParams.region,accessKeyId:u.ossParams.accessKeyId,accessKeySecret:u.ossParams.accessKeySecret,bucket:u.ossParams.bucket}),t.next=4,s.multipartUpload(a,e);case 4:t.sent,r({url:"https://photo.aiyi.live/"+a});case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}())}},"1fe8":function(e,t,r){e.exports=r.p+"static/img/error.e53687be.png"},2708:function(e,t,r){"use strict";var i=r("5530"),n=r("2f62"),a={data:function(){return{tabIndex:"0",page:1,size:10,limit:10,searchParams:{},dataParams:{}}},computed:Object(i["a"])({},Object(n["c"])({permissionArr:function(e){return e.permission.permissionArr}})),mounted:function(){console.log(this.permissionArr,"permissionArr")}};t["a"]=a},"6a85":function(e,t,r){},"6ea6":function(e,t,r){},a4b5:function(e,t,r){"use strict";r("6ea6")},a6662:function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container banner-list-box"},[r("div",{staticClass:"btnBox"},[r("el-button",{attrs:{type:"success"},on:{click:e.add}},[e._v("新增")])],1),r("tableList",{ref:"tableList",attrs:{cfgs:e.cfgs}}),e.isDestoryComp?r("bannerComp",{ref:"bannerComp",on:{destoryComp:e.destoryComp,getList:e.getList}}):e._e()],1)},n=[],a=r("c7eb"),s=r("1da1"),o=(r("d9e2"),r("7db0"),r("d3b7"),r("b0c0"),r("1a72")),u=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"bannerComp-box"},[r("el-dialog",{attrs:{title:e.titie,visible:e.dialogVisible,width:"450px","before-close":e.handleClose},on:{"update:visible":function(t){e.dialogVisible=t},closed:e.closed}},[r("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"130px"}},[r("el-form-item",{attrs:{label:"banner标题",prop:"title"}},[r("el-input",{model:{value:e.ruleForm.title,callback:function(t){e.$set(e.ruleForm,"title",t)},expression:"ruleForm.title"}})],1),r("el-form-item",{attrs:{label:"banner图片",prop:"pic"}},[r("uploadImg",{ref:"uploadImg",attrs:{imgUrl:e.ruleForm.pic,name:"pic",accept:".png,.jpg,.jpeg"},on:{validateField:e.validateField},model:{value:e.ruleForm.pic,callback:function(t){e.$set(e.ruleForm,"pic",t)},expression:"ruleForm.pic"}})],1),r("el-form-item",{attrs:{label:"轮播顺序",prop:"sort"}},[r("el-input",{model:{value:e.ruleForm.sort,callback:function(t){e.$set(e.ruleForm,"sort",t)},expression:"ruleForm.sort"}})],1),r("el-form-item",{attrs:{label:"banner外部链接",prop:"url"}},[r("el-input",{model:{value:e.ruleForm.url,callback:function(t){e.$set(e.ruleForm,"url",t)},expression:"ruleForm.url"}})],1),r("el-form-item",{attrs:{label:"开始时间",prop:"start_time",rules:e.startTime}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择开始时间","value-format":"timestamp","picker-options":e.StartPicker},model:{value:e.ruleForm.start_time,callback:function(t){e.$set(e.ruleForm,"start_time",t)},expression:"ruleForm.start_time"}})],1),r("el-form-item",{attrs:{label:"结束时间",prop:"end_time",rules:e.endTime}},[r("el-date-picker",{attrs:{type:"datetime",placeholder:"选择结束时间","value-format":"timestamp","picker-options":e.EndPicker},model:{value:e.ruleForm.end_time,callback:function(t){e.$set(e.ruleForm,"end_time",t)},expression:"ruleForm.end_time"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确 定")])],1)],1)],1)},c=[],l=(r("b64b"),r("e9c4"),r("4e82"),r("40cb")),m={components:{uploadImg:l["a"]},computed:{StartPicker:function(){return{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}}},EndPicker:function(){return{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}}},startTime:function(){var e=this,t=this.ruleForm.start_time,r=(new Date).getTime(),i={};return i={required:!0,validator:function(i,n,a){t?t<r&&"add"===e.status?a(new Error("开始时间不可小于当前时间")):a():a(new Error("请选择开始时间"))}},i},endTime:function(){var e=this,t=this.ruleForm.start_time,r=(new Date).getTime(),i={};return i={required:!0,validator:function(i,n,a){t?t<r&&"add"===e.status?a(new Error("结束时间不可小于当前时间")):a():a(new Error("请选择结束时间"))}},i},titie:function(){return"add"===this.status?"banner新增":"update"===this.status?"banner修改":void 0}},data:function(){return{status:"add",dialogVisible:!1,ruleForm:{title:"",pic:"",sort:"",url:"",start_time:null,end_time:null},rules:{title:[{required:!0,message:"请输入banner标题",trigger:"blur"}],pic:[{required:!0,message:"请上传banner图片",trigger:"change"}],sort:[{required:!0,message:"请输入轮播顺序",trigger:"blur"}],url:[{required:!1,message:"请输入banner外部链接",trigger:"blur"}],start_time:[{required:!0,message:"请选择开始时间",trigger:"change"}],end_time:[{required:!0,message:"请选择结束时间",trigger:"change"}]}}},methods:{handleClose:function(){this.dialogVisible=!1},loadParams:function(e,t){if(this.status=e,this.dialogVisible=!0,"add"!==e){var r=JSON.parse(JSON.stringify(t));r.start_time=r.start_time?1e3*r.start_time:"",r.end_time=r.end_time?1e3*r.end_time:"",this.$set(this.$data,"ruleForm",r)}},submitForm:function(e){var t=this;return Object(s["a"])(Object(a["a"])().mark((function r(){return Object(a["a"])().wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.$refs[e].validate(function(){var e=Object(s["a"])(Object(a["a"])().mark((function e(r){var i,n,s;return Object(a["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r){e.next=9;break}return i=t.ruleForm,n={id:i.id,title:i.title,pic:i.pic,type:i.type,status:i.status,ps:i.ps,sort:i.sort,url:i.url,start_time:Math.floor(i.start_time/1e3),end_time:Math.floor(i.end_time/1e3)},e.next=5,Object(o["H"])(n);case 5:s=e.sent,2e3===s.code&&("add"===t.status?t.$message.success("新增成功"):t.$message.success("修改成功"),t.dialogVisible=!1,t.$emit("getList")),e.next=11;break;case 9:return console.log("error submit!!"),e.abrupt("return",!1);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return r.stop()}}),r)})))()},resetForm:function(e){this.$refs[e].resetFields()},closed:function(){this.$emit("destoryComp")},validateField:function(e){this.$refs.ruleForm.validateField([e])}}},d=m,p=(r("a4b5"),r("2877")),f=Object(p["a"])(d,u,c,!1,null,null,null),b=f.exports,g=r("4053"),h=r("8daa"),v=r("cf45"),w=r("2708"),F=r("279a"),_={name:"banner-list",mixins:[w["a"]],components:{bannerComp:b,tableList:g["a"]},data:function(){return{isDestoryComp:!1}},computed:{StartPicker:function(){return{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}}},EndPicker:function(){return{disabledDate:function(e){return e.getTime()<(new Date).getTime()-864e5}}},startTime:function(){var e=this,t=this.popForm.start_time,r=(new Date).getTime(),i={};return i={required:!0,validator:function(i,n,a){t<r&&"Add"===e.type?a(new Error("开始时间不可小于当前时间")):a()}},i},endTime:function(){var e=this,t=this.popForm.start_time,r=(new Date).getTime(),i={};return i={required:!0,validator:function(i,n,a){t<r&&"Add"===e.type?a(new Error("结束时间不可小于当前时间")):a()}},i},cfgs:function(){var e=this;return{vm:this,url:h["a"].system.banner.getBanner,columns:[{label:"序号",prop:"sort"},{label:"banner标题",prop:"title"},{label:"轮播顺序",prop:"sort"},{label:"banner图片",isimg:!0,prop:"pic",imgHeight:"50px"},{label:"banner类型",render:function(e,t){var r=F["a"].BANNERSYSTEMTYPELIST.find((function(e){return e.value===t.row.type}));return e("span",r?r.name:"无")}},{label:"更新时间",render:function(e,t){return e("span",t.row.update_time?Object(v["h"])(t.row.update_time,"YYYY-MM-DD HH:mm:ss",!0):"无")}},{label:"启用/禁用",isSwitch:!0,prop:"status",isTrueValue:1,isFalseValue:2,change:function(t,r){e.changeSwitch(r.id,t)}},{label:"操作",render:function(t,r){return t("div",[t("el-button",{props:{type:"primary"},on:{click:function(){e.update(r.row)}}},"修改")])}}]}}},methods:{beforeSearch:function(e){return{page:e.page,pagesize:e.size}},getList:function(){this.$refs.tableList.getData()},reset:function(){this.searchParams={},this.getList()},onSearch:function(){this.getList()},add:function(){this.load("add")},update:function(e){this.load("update",e)},load:function(e,t){var r=this;this.isDestoryComp=!0,setTimeout((function(){r.$refs.bannerComp.loadParams(e,t)}),50)},destoryComp:function(){this.isDestoryComp=!1},changeSwitch:function(e,t){var r=this;return Object(s["a"])(Object(a["a"])().mark((function i(){var n,s;return Object(a["a"])().wrap((function(i){while(1)switch(i.prev=i.next){case 0:return n={id:e,status:1===t},i.next=3,Object(o["H"])(n);case 3:s=i.sent,2e3===s.code&&(1===t?r.$message.success("启用成功"):r.$message.success("禁用成功"),r.getList());case 5:case"end":return i.stop()}}),i)})))()}}},k=_,y=(r("c023"),Object(p["a"])(k,i,n,!1,null,null,null));t["default"]=y.exports},c023:function(e,t,r){"use strict";r("6a85")}}]);